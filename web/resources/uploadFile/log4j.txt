title=Add Spring Boot integration to Log4j Boot
explanation=The Spring Boot integration packaged by Spring for Log4j2 uses SLF4J libraries instead of the Log4j ones. 
explanation=This module should use native Log4j bridges and use native functionality wherever possible.
want=This should include sensible default config files ported from spring-boot-starter-log4j2.


title=Dynamic Subject for SMTP Appender
drawback=It is annoying to have log messages sent to users via SMTP Appender with a static subject, requiring recipients to open each of possibly a vast amount of log emails in order to find out what went wrong.
want=Users should be able to insert runtime diagnostic context information to the message text AND to the message subject as well.
explanation=While the first seems to be working with Patternlayout using the mechanism with the %X pattern based on a NDC or MDC <key> in the "ConversionPattern" parameter, it does NOT work with the "Subject" parameter with log4j (neither 1.2 nor 2.x), though some bloggers suggest it, e.g. <LINK>.
example=See <LINK> as an example where others found this also.
want=This issue should have been fixed long ago.
want=I suggest to extend SMTP appender in order to be able to use %X and other Pattern conversion in the "Subject" parameter properly.
example=<LINK> has already done the part for applying PatternLayout to the SMTP Appender "Subject". 
explanation=I didn't test if this works properly. 
explanation=Maybe this work can be included into log4j with minimal effort?
explanation=This feature has originally been realized in LOGBACK using an MDC in Patternlayouts: <LINK>


title=Add a ScriptAppenderSelector to create an Appender specified by a Script
want=The use case is to create an OS-based dynamic configuration file.
explanation=The script determines which appender to use (once), and instantiates that appender (once). 
drawback=There is no need for one appender to delegate to another appender.
explanation=This feature helps you build your configuration dynamically, all from the configuration file, to determine which appenders to configure. 
explanation=This is different from using a RoutingAppender which creates a level of indirection and decides what to do for each log event at runtime.
explanation=You can use multiple ScriptSelector Appenders if needed.
example=For example:<CODE>


title=Line-wise common suffix support for %ex pattern
explanation=The LOG4J2-1838<LINK> issue provide us with the feature to print a common suffix to each line of a stack trace. 
drawback=But it only implemented the feature for the %rEx and %xEx pattern, not yet for the %ex pattern. 
want=This issue is intended to implement the feature for the %ex pattern.

 
title=Please facilitate subclassing Logger and LoggerContext (in org.apache.logging.log4j.core)
want=I would like to create a custom logger, while reusing the <FILE> functionality.
explanation=The following two changes would make subclassing possible:<LIST>
want=My use case is that I want to create an asynchronous Logger for low latency logging.
explanation=This custom logger hands off control to a separate thread as early as possible. 
drawback=In my case, AsynchAppender is not a good match for my requirements, as with that approach (a) the logging call still needs to flow down the hierarchy to the appender, doing synchronization and creating objects at various points on the way, and (b) when serializing the LogEvent, the getSource() method is always called, which is expensive.


title=Add support for appending common suffix to each line of throwable stack trace
want=Add support for appending common suffix to each line of throwable stack trace. 
explanation=The suffix can be configured by patterns just like patterns used elsewhere.
example=For example, pattern %xEx{suffix(- %mdc{key})} will append a string generated by pattern - and %mdc{key}.
drawback=But patterns that handles throwable will be automatically ignored, because they will make the rendered result confusing. 
explanation=So pattern %xEx{suffix(- %rEx%mdc{key})} has the same effect with %xEx{suffix(- %mdc{key})}, as if the nested %rEx pattern has never appeared.
example=Following is an example of the with such suffix: <CODE>


title=Add StatusLoggerRule to allow unit tests to set a status level
want=In unit tests that do not use a configuration file, it would be useful to have a JUnit rule that allows the default status logger level to be set. 
example=For example, some tests are for error scenarios that spew out a lot of status messages that are expected errors and make the unit test output hard to interpret. 
explanation=In such tests, this rule could be used to set the level to FATAL or OFF. 
explanation=This could also be used for debugging purposes.


title=Add support for java.util.concurrent.LinkedTransferQueue to AsyncAppender
want=Add support for the Java 1.7+ class LinkedTransferQueue as an alternative to using ArrayBlockingQueue. 
want=In addition, this class provides the tryTransfer() method which is faster than using offer(), so add support for using that.


title=Allow one of a number of patterns to be used in PatternLayout
want=It is desirable to be able to format messages using different patterns based on attributes of the LogEvent. 
example=For example, it would be useful to format events with the FLOW marker differently than normal events.


title=Provide access to config properties in LoggerConfig
drawback=Custom Loggers that want to support configuration properties when creating custom LogEvent objects currently have no easy way to access these configuration Property objects.
explanation=The configuration Property map in LoggerConfig is private. 
want=Please provide an accessor method that returns a (read-only) view of this Property map.
example=proposal: add below method to <PATH>: <CODE>


title=Allow Builders to be completely generic
want=Allow Builders to be completely generic. 
explanation=This is not just supporting Builder<T>, which works in 2.6.2, but to allow declarations like Builder<B extends Builder<B>> combined with setters that return B.
useless=I have a patch for this
explanation=The next step (and ticket) will be to allow to use a Builder that extends another Builder.


title=Add lookup for JVM arguments
want=Access JVM input properties with the prefix jmx-input by index or name, 
example=like main arguments for LOG4J2-771.


title=Add ThreadContextMap.putAll(Map<String, String>)
want=Add API <CODE>.
want=My immediate goal is to be able to build a JUnit Rule to save and restore the thread context around each unit test method and/or a given class.
example=See LOG4J2-1517<LINK>.


title=Please provide means to disable NDC functionality on a global level.
explanation=Disabling NDC evaluation can have drastic effects on event size while sending them over the wire or dumping them to disk.
explanation=When disabled, all calls to NDC-related methods will instead call NOP implementations, 
drawback=for example, no ThreadLocals would be used at all.


title=Add optional support for Conversant DisruptorBlockingQueue in AsyncAppender
benefit=Conversant Disruptor works as an implementation of BlockingQueue that is much faster than ArrayBlockingQueue. 
benefit=I did some benchmarks earlier and found it to be a bit faster:


title=Configure RandomAccessFileAppender buffer size
want=Add feature for Appenders to support buffer, which will store log in to memory(app/system) and write in to file when it reaches buffer size provided.
useless=this is possible?
explanation=If this feature is already available, could you please provide me reference for it?
useless=Thanks in advance.


title=Add converters and validators related to hostnames and ports
want=Add TypeConverter implementations for InetAddress, and add a constraint validator for a valid hostname. 
benefit=This would be useful for plugins such as a Cassandra appender (LOG4J2-1730).


title=New Appender for Apache Kafka
want=It would be useful to have an Appender which sends log events to an Apache Kafka topic.


title=Add TLS support to SyslogAppender
explanation=Currently, there is no TLS support in SyslogAppender.
want=It would be very nice if one could send encrypted syslog messages to syslog daemons.
explanation=I think the use cases are obvious: you want to protect your syslog messages against masquerade, modification and disclosure.


title=TCP and UDP socket servers should be able to handle JSON log events
want=TCP and UDP socket servers should be able to handle JSON log events
example=The following will implement the conversion: <CODE>


title=Please provide means to disable MDC functionality on a global level.
drawback=Disabling MDC evaluation can have drastic effects on event size while sending them over the wire or dumping them to disk.
explanation=When disabled, all calls to MDC-related methods will instead call NOP implementations, 
drawback=for example, no ThreadLocals would be used at all.


title=Add a way to route messages based on the %marker in Layout for RoutingAppender
useless=Hi,
explanation=It seems there's no way to route messages based on the Marker in the RoutingAppender. 
explanation=The "%marker" is not part of the Layout. 
benefit=When using SLF4J, since it's a core feature of the facade, this would help greatly if it was possible to route messages based on the Marker.
example=Main StackOverFlow question (answered) : <LINK>
example=Workaround StackOverFlow question (answered) : <LINK>
useless=Thank you


title=Introduce interfaces IndexedStringMap and IndexedReadOnlyStringMap
want=This ticket proposes to introduce a public interface that imposes a total ordering over the keys of a (ReadOnly)StringMap. 
explanation=This interface views all key-value pairs as a sequence ordered by key, and allows keys and values to be accessed by their index in the sequence.
explanation=The intention is to let SortedArrayStringMap implement these interfaces. 
explanation=It already implements the necessary methods; the visibility of these methods will change from package-protected to public.
benefit=These interfaces help reduce log4j's dependency on the JDK Map interface: the JDK Map interface does not provide a garbage-free way to iterate over all its keys or key-value pairs.
example=For example, these interfaces can be used to make MapFilter and its subclasses garbage-free, and reduce allocation of temporary objects in MapMessage and subclasses.


title=Add MessageFactory that reuses a cached Message instance
explanation=As discussed in LOG4J2-1270, all current MessageFactory implementations create new temporary Message objects. 
explanation=A GC-free configuration needs a different MessageFactory that reuses Message instances.
explanation=When Messages are being reused, async logging components need to be aware of this and ensure the Message content (rather than the Message instance itself) is passed to the background thread. 
want=However, Messages that are not reusable should be passed to the background thread unchanged.


title=Stream-Interface for Loggers
want=I would like to have method (or class) to use a logger as a PrintStream, like for example: <CODE>
example=or maybe like this <LINK>


title=New RewritePolicy for changing level of a log event
want=It would be useful to have a RewritePolicy for changing the level of a log event.
want=Some 3rd party libraries log stuff on wrong level, and I would like to be able to translate it.


title=Provide enhanced logger filtering support.
explanation=We wrote our own logging framework primarily because log4j didn't provide some of the features we needed. 
explanation=Our software runs on behalf of many companies, products and users all in the same JVM. 
want=We have a requirement to be able to enable logging based on some of these factors. 
explanation=For example, we might want to enable debug logging only for a specific company or even a specific user. 
explanation=All our requests store attributes, such as the companyId, product name and userid in the MDC.
want=So the real requirement here is to be able to filter log records early based on more information than just the log level. 
example=For example, our requirement could be met by a filter that could be configured to associate a log level with a company id. 
explanation=Then when debug is called a check would first be done to see if debug was enabled for that company id and then whether debug was enabled for that logger. 
explanation=These checks cannot be done as filters on Appenders as the performance of the system is dramatically impacted as isDebugLogging really needs to return false for all company ids other than the one that is enabled.
want=This feature is similar to LogBack's TurboFilter, except I would like it implemented differently. 
explanation=I would recommend that the filter be specified globally but referenced on each logger to which it applies, much as the specification of Appenders is done.


title=JNDI Lookup plugin support
explanation=Currently, Lookup plugins don't support JNDI resources.
benefit=It would be really convenient to support JNDI resource lookup in the configuration.
explanation=One use case with JNDI lookup plugin is as follows:
want=I'd like to use RoutingAppender to put all the logs from the same web application context in a log file (a log file per web application context).
want=And, I want to use JNDI resources look up to determine the target route (similarly to JNDI context selector of logback).
benefit=Determining the target route by JNDI lookup can be advantageous because we don't have to add any code to set properties for the thread context and JNDI lookup should always work even in a separate thread without copying thread context variables.


title=Add a logformat token for nanotime
explanation=Add a token in the log format specifier to output the current value of <CODE>.
benefit=We are currently adding the nanotime value to our log messages manually, which we find very useful for troubleshooting unexpected latency, and as a quick-and-dirty data source to feed into performance analysis tools.
want=It would be very nice if Log4j could do this for us. 
want=It would also be nice to have this in the log format specified, so we can turn it on/off at runtime by editing the Log4j config file.


title=Better control over timestamp
explanation=For apps which require very accurate event times, the timestamp must be provided by the app. 
explanation=In log4j 1.2 it is assigned when the event is created, which is the time the event is appended. 
explanation=This could be many milliseconds after the actual generation of the event. 
explanation=This also gives the app the ability to collect event milestones and then choose at the end of the processing whether or not to have them sent to an appender and still control the timestamp.


title=Allow RollingFileAppender to do Rolling with a Date Pattern or DailyRollingFileAppender to have Max Backup Parameter
want=It would be nice to be able roll files with a date pattern and not just an index while still being able to specify the max file size and number of copies to keep. 
want=Alternatively it would be good to be able to us the DailyRollingFileAppender with a max copies to keep parameter


title=Scala wrapper for Log4j 2 API
explanation=Scala wrapper for Log4j 2 API which makes use of Scala features like macros and string interpolation.
want=Inspired from Typesafe's Scala Logging but should use Log4j 2 directly and expose its features.


title=API change: add methods for logging CharSequences (was: Provide support for CharSequence parameters for low and zero-GC applications)
explanation=Currently, the preferred way of logging character sequences in log4j 2 is by passing in tokens of type <CODE>. 
benefit=It would be very beneficial if the API could provide methods that take <CODE> tokens. 
benefit=This would allow high performance zero or low-GC applications to re-use the existing mutable structures implementing <CODE> for continuous logging without new objects being created.
explanation=A high-performance implementation of the logger would be expected to copy out the contents of a single or multiple instances of <CODE> so that they could be re-used in the subsequent logging call.


title=[PatternLayout] Add an ANSI option to %xThrowable
example=See screenshot attachments.
want=The idea is to print out exceptions to the console using colors to make some information more obvious and liven things up. 
drawback=The current style choices are arbitrary as are the style names Spock and Kirk.
explanation=This is currently in branch StyledXException.
benefit=A positive side effect of this code is that extended exceptions are rendered on a StringBuilder so less garbage is generated.


title=Add support for embedding the Flume agent into the Flume Appender.
explanation=Apache Flume provides guaranteed delivery to the target log repository. 
explanation=Embedding the agent into the Appender means control will be returned to the application as soon as possible.


title=Specify the SocketAppender connect timeout value as part of the configuration
explanation=I was testing the use case of taking the logserver down for maintenance and noticed that the SyslogAppender doesn't provide a way to override the default socket timeout. 
explanation=This resulted in my application noticeably hanging on startup when waiting for the socket to timeout.
explanation=As a short term fix I created an extension largely based on the SyslogAppender that includes the connection timeout as a configurable parameter (timeoutMillis). 
want=I'd like something like this to be added in a future revision so I don't have to maintain this extension. 
explanation=Here's my version:


title=Date based file appender
want=I'd like to reintroduce the option of logging to a file that has the current date in it.
example=For example, when the app starts up, it will start logging to <FILE>. 
explanation=At midnight, it starts logging to a new file named <FILE>.
explanation=Log4j2's RollingFileAppender does not support this. 
explanation=In log4j2 the file appender will log to one file with a static file name, and then the content is moved over to another file.
explanation=This used to be a feature in log4j 1.3, when using extras. 
example=I would configure it like this:


title=Support composite configurations
explanation=Support was added to XMLConfiguration to allow XIncludes in the XML files. 
benefit=While this can be useful it does not allow for the use case where someone wants a default configuration and then a custom configuration to be merged with it.
want=I am proposing creating a CompositeConfiguration class that accepts a comma separated list of configuration files. 
explanation=It would then use the Configuration factories to create the appropriate Configuration classes for each of the underlying files. 
explanation=It would then merge the Node hierarchies created by each into a single tree and then finally construct the actual configuration Objects from that tree.
explanation=There are a few issues with this - 
example=for example each configuration can specify debug and verbose attributes, duplicate property settings, handling duplicate Appender names, etc. 
want=Most of these should be fairly easy to resolve.


title=The Logging API should support a Message object
explanation=RFC 5424 defines StructuredData. 
explanation=While implementing this for Logback it was found that making SLF4J support a Message interface and then providing Message definitions for a "SimpleMessage" (message text only), "ParamaterizedMessage" (message plus substitution parameters) and StructuredDataMessage (a message that allows the formatted message to conform to RFC 5424) allows the API to be easily extendable with new Message types and makes it more efficient to pass them through the logging implementation.
want=Log4j 2.0 should incorporate this into both the API and the implementation. 
benefit=This will allow for easy implementation of a SyslogAppender that conforms with the new Syslog specification 
example=see <LINK>
explanation=as well as using the RFC 5424 as a standard layout that can be used to transport messages via JMS or other protocols.
example=See <LINK> and <LINK> for examples of how I accomplished this for slf4j and logback.


title=Allow plugins outside of Log4j 2 core to be preloaded.
benefit=Loading plugins in Log4j 2 core is fast and easy because they have been added to the preload map. 
explanation=However, the FlumeNG appender and components in other packages must be loaded at runtime. 
want=This enhancement should allow any component to contain a preload map and all of them should be loaded together.


title=Support existing ability to modify any of an event's fields
explanation=RewriteAppender and RewritePolicy in log4j 1.2 give appender writers the ability to change events before they are sent to appenders. 
example=Two examples: 


title=Add optional support for JCTools in AsyncAppender
want=Spawning from the discussion in LOG4J2-1430, this feature request is to add support for using JCTools MPSC bounded lock-free queue in AsyncAppender.
explanation=As the work for this issue stems from the work in 1430, the code is all contained in the same branch.


title=Add Cassandra (NoSQL) appender
want=Add an appender for Cassandra. 
explanation=This should be able to follow the same pattern as the other NoSQL appenders, or possibly the JDBC style appenders as Cassandra does normally use a SQL-like language called CQL.
example=There are numerous Java drivers available for Cassandra: <LINK>
want=The main driver I'm familiar with is the Datastax driver as it's the one used by spring-data, but it may be worth comparing the various drivers to see if any of them would fit better into the architecture of log4j already.


title=Serialize configuration into a log4j2.xml file
want=This would be useful for e.g. converting from Log4j 1 to Log4j 2 config.


title=Add a TypeConverter for UUID
want=Add a TypeConverter for UUID. 
benefit=This will be useful in custom appenders that wish to convert a string into a native UUID 
example=for example, the UUID column type in Cassandra or Postgres


title=Automated testing to verify no temporary objects allocated in gc-free configuration
explanation=LOG4J2-1270 proposes changes to support gc-free behaviour (no allocation of temporary objects) in certain configurations.
want=This ticket is about verifying that Log4j does not allocate in these configurations. 
benefit=It is not always obvious that some code creates objects, so it is easy for regressions to creep in during maintenance code changes.
explanation=Ideally this verification is packaged so it can run automatically during the test phase of the build, 
example=for example in a JUnit test.


title=WebLookup
want=Add a "web" lookup plugin for resolving a webapp's root directory. 
explanation=Investigate whether it can be included in BaseConfiguration's list of hard-wired plugins.


title=Allow shutdown hook registration handling to be customizable
want=Besides the ability to enable or disable the shutdown hook, there should be a ShutdownRegistrationStrategy interface for customizing how to register a shutdown callback in LoggerContext. 
explanation=This will allow application servers to specify their own class that can register the shutdown callback for a LoggerContext.
want=To make this really flexible, Log4jContextFactory should be the class that creates the ShutdownRegistrationStrategy.
explanation=The basic idea behind this feature is already implemented. 
want=I'd like to make this API a bit better before 2.1 so we aren't stuck with a useless interface later on.


title=Create a YAML layout
want=Create a YAML layout; 
explanation=this will reuse what we already have for XML and JSON through Jackson.


title=Create SMTPAppender
explanation=Somebody in twitterverse reverted back to log4j 1.2 because he missed the SMTP Appender


title=Update Logger Wrapper Generator tool for new API methods
explanation=The Logger interface has additional methods that accept a CharSequence (LOG4J2-1326) and with unrolled varargs (LOG4J2-1278).
want=The Generate tool should generate code for these methods.


title=JMX Client GUI should dynamically update when LoggerContext MBeans are registered/unregistered in MBean server
explanation=Currently the Log4J2 JMX Client GUI will take a snapshot of the MBean server state when the client GUI is started. 
explanation=The GUI displays a tab for each LoggerContextAdmin MBean that existed at startup time.
explanation=This is a static snapshot: these tabs do not change if the LoggerContext MBean is unregistered while the GUI is active. 
explanation=Also, if additional LoggerContext MBeans are registered after the GUI was started, the GUI will not be "aware" of this and will not display new tabs for the added LoggerContext.
want=This ticket is a request to dynamically update the GUI in response to LoggerContext MBeans being registered/unregistered after the GUI was started.


title=Add support for JSR 223 scripts in filters and the PatternSelector.
explanation=Sometimes more flexibility is required in filtering and in selecting a pattern for the PatternLayout. 
explanation=This enhancement provides support for JSR 223 scripts.


title=Provide support for SLF4J type Markers
explanation=We wrote our own logging framework primarily because log4j didn't provide some of the features we needed. 
explanation=One feature was more granularity, especially around logging. 
explanation=We encourage entry and exit tracing, logging of input and output data, logging of elapsed time statistics and several other flavors if "debug" information. 
drawback=Turning all this on in production generates too much data. 
explanation=Our framework supported the concept of Log Type in addition to Log Level. 
explanation=When filtering there was a LogType array where each array element was the log level. 
benefit=The LogRecord contained the LogType and LogLevel so doing filtering was very fast.
explanation=SLF4J supports Markers.
explanation=These can essentially be used for the same purpose (assuming another Jira issue regarding filtering is implemented). 
explanation=Markers are much more flexible since they can be arbitrarily created. 
want=Loggers should then be able to filter on whether a marker is present in addition to the LogLevel.


title=Ability to change the fileName dynamically in RollingFileAppender
explanation=Right now RollingFileAppender rolls over the current file with fileName to the one generated by FilePattern. 
example=However, logging always continues in the same fileName for example fileName once created cannot be changed.
drawback=Property Substitution is only once during initialization, fileName is never changed after RollingFileManager is initialized. 
explanation=The RollingFileManager is very tightly tied up to the fileName attribute.
want=Consider that I want to name my log files like this using RollingFileAppender:
drawback=There is no good way to achieve this, because even after rolling over the file, the fileName would still remain the same. 
drawback=If I initialized my fileName using ${date:yyyy-MM-dd}, date would be substituted only once during initialization and it would never change, always continue to log in the same log file (until I restart my application).


title=Create a Layout and SyslogAppender that support RFC 5424
explanation=RFC 5424 (<LINK>) was made a standard in March of 2009. 
want=Log4j 2.0 should provide a Layout and SyslogAppender that implements this standard.


title=Drop events when the RingBuffer is full
explanation=I am running into performance issue with an appender, in a certain scenario (attached at the bottom), that causes RingBuffer to reach its full capacity. 
explanation=When that happens I can see that my app throughput drops significantly.
benefit=I think it will be really useful to be able to configure the RingBuffer handler to be able to drop events whenever the buffer reaches its capacity, instead of what seems currently as blocking, as I don't want the logging to affect the main application.
explanation=Here is the scenario that led me to this request:
explanation=I am currently testing the log4j-flume-ng appender and running into some issues. 
explanation=It seems like whenever log4j appender fails to log an event it causes the disruptor ring buffer to get full which slows down the whole system.
example=My setup looks more or less like that: 
explanation=Here are my findings:
benefit=When Flume (process 2) is up and running, everything actually looks really good. 
explanation=The ring buffer capacity is almost always full and there are no performance issues. 
explanation=The problem starts when I shut down process 2 - I am trying to simulate a case in which this process crashes, as I do not want it to effect process 1. 
explanation=As soon as I shut down flume I start getting exceptions produced by log4j telling me they cannot append the log - so far it makes sense. 
explanation=The thing is, that at the same time I can see that the ring buffer starts to fill up. 
explanation=As long as it's not totally full process 1 throughput stays the same. 
explanation=The problem gets serious as soon as the buffer reaches full capacity. 
explanation=When that happens the throughput drops in 80% and it does not seem to recover from this state. 
explanation=But, as soon as I restart process 2, things get back to normal pretty quick - the buffer gets emptied, and the throughput climbs back to what it was before. 
drawback=I assume that from some reason a fail to append makes the RingBuffer consumer thread significantly slower.
benefit=Besides checking why the flume appender preform slower when an exception is thrown, I wish I could just discard the log events when the buffer gets full.


title=Add JSON encoding support to EncodingPatternConverter %encode{}.
explanation=The existing implementation of EncodingPatternConverter is for escaping output for HTML specifically. 
want=This pattern converter should be extended to allow multiple types of encoding. 
want=The existing HTML behavior should be the default, but an optional second parameter should be added to allow specifying a different format to encode for.
example=For JSON, encoding would require the following:


title=Add support for filtering input in TcpSocketServer and UdpSocketServer
benefit=It is best practice to add a configurable class filter to ObjectInputStream usage when input comes from untrusted sources. 
explanation=Add this feature to TcpSocketServer and UdpSocketServer along with sensible default settings. 
explanation=This feature is unnecessary in JmsServer as that relies on the underlying configuration of the JMS server 
example=for example, ActiveMQ has a similar configuration option
